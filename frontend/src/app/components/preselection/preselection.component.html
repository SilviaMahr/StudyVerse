<form class="preselection-container" #preselectionForm="ngForm" (ngSubmit)="onSubmit(preselectionForm)">
  <img src="assets/UNI.png" alt="Maskottchen" class="mascot">
  <h2>Neue Planung starten</h2>
  <p>Lass uns die Sache gemeinsam angehen und dein nächstes Semester planen!<br><br>
    Denk daran, deine <a href="/lva-management"> abgeschlossenen LVAs</a> aktuell zu halten.</p>

  <div class="form-group">
    <label for="semester">Semester für das geplant werden soll:</label>

    <select id="semester"
            [(ngModel)]="selectedSemester"
            name="semester"
            required
            #semesterModel="ngModel">
      <option [ngValue]="null" disabled>Bitte auswählen...</option>
      <option value="WS25">Wintersemester 2025/26</option>
      <option value="SS26">Sommersemester 2026</option>
      <option value="WS26">Wintersemester 2026/27</option>
    </select>
  </div>

  @if (semesterModel.invalid && (semesterModel.dirty || semesterModel.touched)) {
    <div class="validation-error">
      Bitte wähle ein Semester aus.
    </div>
  }

  <div class="form-group">
    <label for="ects">Max. ECTS pro Semester:</label>
    <input
      type="number"
      id="ects"
      [(ngModel)]="selectedECTS"
      name="ects"
      min="1"
      max="60"
      placeholder="z.B. 30"
      required
      #ectsModel="ngModel"

      pattern="^\d+(\.5)?$">
  </div>

  @if (ectsModel.invalid && (ectsModel.dirty || ectsModel.touched)) {
    <div class="validation-error">
      @if (ectsModel.errors?.['required']) {
        Bitte gib die maximalen ECTS an.
      }
      @if (ectsModel.errors?.['min'] || ectsModel.errors?.['max']) {
        Bitte gib einen Wert zwischen 1 und 60 an.
      }
      @if (ectsModel.errors?.['pattern']) {
        Bitte gib nur ganze Zahlen oder 0,5er-Schritte ein (z.B. 25.5).
      }
    </div>
  }

  <fieldset class="form-group">
    <legend>An welchen Tagen möchtest du LVAs besuchen?</legend>
    <div class="days-checkbox-group">

      <label class="checkbox-label">
        <input type="checkbox" [(ngModel)]="days.monday" name="monday" (change)="onDayChange()"> Mo
      </label>
      <label class="checkbox-label">
        <input type="checkbox" [(ngModel)]="days.tuesday" name="tuesday" (change)="onDayChange()"> Di
      </label>
      <label class="checkbox-label">
        <input type="checkbox" [(ngModel)]="days.wednesday" name="wednesday" (change)="onDayChange()"> Mi
      </label>
      <label class="checkbox-label">
        <input type="checkbox" [(ngModel)]="days.thursday" name="thursday" (change)="onDayChange()"> Do
      </label>
      <label class="checkbox-label">
        <input type="checkbox" [(ngModel)]="days.friday" name="friday" (change)="onDayChange()"> Fr
      </label>
      <label class="checkbox-label">
        <input type="checkbox"
               [(ngModel)]="days.noRestriction"
               name="keineEinschraenkungen"
               (change)="onNoRestrictionChange()"> keine Einschränkungen
      </label>

      @if (!isDaySelected && preselectionForm.submitted) {
        <div class="validation-error">
          Bitte wähle mindestens einen Tag aus.
        </div>
      }

    </div>
  </fieldset>

  <div class="form-group">
    <label for="preferredCourses">Gibt es Lehrveranstaltungen, die du unbedingt besuchen möchtest?</label>
    <textarea
      id="preferredCourses"
      [(ngModel)]="preferredCourses"
      name="preferredCourese"
      rows="3"
      placeholder="z.B. PR DKE, VL Software Engineering"></textarea>
  </div>

  @if (successMessage) {
    <div class="success-message">
      {{ successMessage }}
    </div>
  }

  <button type="submit"
          class="start-button"
          [disabled]="!preselectionForm.valid || !isDaySelected">
    Planung starten</button>

</form>
